<?xml version="1.0" encoding="utf-8"?>
<extension type="plugin" group="system" method="upgrade">
    <name>PLG_SYSTEM_ACCESSKEY</name>
    <description>PLG_SYSTEM_ACCESSKEY_XML_DESCRIPTION</description>
    <author>Jeroen Moolenschot | Joomill</author>
    <authorEmail>info@joomill-extensions.com</authorEmail>
    <authorUrl>https://www.joomill-extensions.com</authorUrl>
    <license>GNU General Public License version 3 or later</license>
    <creationDate>September 2025</creationDate>
    <copyright>(C) 2025 Joomill Extensions</copyright>
    <version>2.0.0</version>
    <namespace path="src">Joomill\Plugin\System\Accesskey</namespace>

    <!-- Scripts to run on installation -->
    <scriptfile>script.php</scriptfile>

    <!-- Files -->
    <files>
        <filename plugin="accesskey">script.php</filename>
        <folder>language</folder>
        <folder>services</folder>
        <folder>src</folder>
    </files>

    <!-- Configuration / Parameters -->
    <config>
        <fields name="params" addfieldprefix="Joomill\Plugin\System\Accesskey\Field">
            <fieldset name="basic">
                <field
                    name="key"
                    type="text"
                    default=""
                    label="PLG_SYSTEM_ACCESSKEY_KEY_LABEL"
                    description="PLG_SYSTEM_ACCESSKEY_KEY_DESC"
                    required="true"
                />

                <field
                    name="whitelist"
                    type="text"
                    size="50"
                    default=""
                    label="PLG_SYSTEM_ACCESSKEY_WHITELIST_LABEL"
                    description="PLG_SYSTEM_ACCESSKEY_WHITELIST_DESC"
                />

                <field
                    name="ipAddress"
                    type="ip"
                    label="PLG_SYSTEM_ACCESSKEY_CURRENT_IPADDRESS_LABEL"
                    description="PLG_SYSTEM_ACCESSKEY_CURRENT_IPADDRESS_DESC"
                />

                <field
                    name="failAction"
                    type="radio"
                    class="btn-group"
                    default="message"
                    label="PLG_SYSTEM_ACCESSKEY_FAIL_ACTION_LABEL"
                    description="PLG_SYSTEM_ACCESSKEY_FAIL_ACTION_DESC">
                <option value="message">PLG_SYSTEM_ACCESSKEY_FAIL_ACTION_MESSAGE</option>
                <option value="redirect">PLG_SYSTEM_ACCESSKEY_FAIL_ACTION_REDIRECT</option>
                </field>

                <field
                    name="message"
                    type="textarea"
                    default="There is nothing to see here!"
                    label="PLG_SYSTEM_ACCESSKEY_MESSAGE_LABEL"
                    description="PLG_SYSTEM_ACCESSKEY_MESSAGE_DESC"
                    showon="failAction:message"
                />

                <field
                    name="redirectUrl"
                    type="url"
                    label="PLG_SYSTEM_ACCESSKEY_REDIRECT_LABEL"
                    description="PLG_SYSTEM_ACCESSKEY_REDIRECT_DESC"
                    showon="failAction:redirect"
                />

                <field
                    name="whitelist_message"
                    type="textarea"
                    default=""
                    label="PLG_SYSTEM_ACCESSKEY_WHITELIST_MESSAGE_LABEL"
                    description="PLG_SYSTEM_ACCESSKEY_WHITELIST_MESSAGE_DESC"
                />
            </fieldset>
        </fields>
    </config>

    <!-- Changelog -->
    <changelogurl>
        <![CDATA[https://www.joomill-extensions.com/index.php?option=com_ochsubscriptions&amp;view=changelog&amp;format=xml&amp;cat=19]]>
    </changelogurl>

    <!-- Updateserver -->
    <updateservers>
        <server type="extension" name="Joomill Access Key">
            <![CDATA[https://www.joomill-extensions.com/index.php?option=com_ochsubscriptions&amp;view=updater&amp;format=xml&amp;cat=19]]>
        </server>
    </updateservers>
</extension>
